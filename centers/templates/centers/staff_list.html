{% extends 'base.html' %}
{% load static %}

{% block page_title %}Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-transparent border-0 py-3 d-flex justify-content-between align-items-center">
                <h5 class="fw-bold m-0 text-primary">Ù‚Ø§Ø¦Ù…Ø© Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ²</h5>
                <a href="{% url 'centers:add_staff' %}" class="btn btn-primary rounded-pill px-4">
                    <i class="fas fa-plus me-1"></i> Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯
                </a>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light text-muted small text-uppercase">
                            <tr>
                                <th class="ps-4">Ø§Ù„Ù…ÙˆØ¸Ù</th>
                                <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„Ø¯ÙˆØ±</th>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th class="text-end pe-4">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for staff in staff_members %}
                            <tr>
                                <td class="ps-4">
                                    <div class="d-flex align-items-center">
                                        <div class="bg-soft-primary text-primary rounded-circle d-flex justify-content-center align-items-center me-3"
                                            style="width: 40px; height: 40px;">
                                            {{ staff.first_name|slice:":1" }}{{ staff.last_name|slice:":1" }}
                                        </div>
                                        <div>
                                            <div class="fw-bold text-dark">{{ staff.first_name }} {{ staff.last_name }}
                                            </div>
                                            <div class="small text-muted">{{ staff.phone|default:"-" }}</div>
                                        </div>
                                    </div>
                                </td>
                                <td><span class="font-monospace text-muted">{{ staff.username }}</span></td>
                                <td>
                                    {% if staff.role == 'CENTER_MANAGER' %}
                                    <span class="badge bg-soft-warning text-warning">Ù…Ø¯ÙŠØ± Ù…Ø±ÙƒØ²</span>
                                    {% else %}
                                    <span class="badge bg-soft-info text-info">Ù…ÙˆØ¸Ù ØµØ­ÙŠ</span>
                                    {% endif %}
                                </td>
                                <td class="text-muted small">{{ staff.date_joined|date:"Y/m/d" }}</td>
                                <td>
                                    {% if staff.is_active %}
                                    <span class="badge bg-success">Ù†Ø´Ø·</span>
                                    {% else %}
                                    <span class="badge bg-danger">Ù…ÙˆÙ‚Ù</span>
                                    {% endif %}
                                </td>
                                <td class="text-end pe-4">
                                    {% if staff.id != request.user.id %}
                                    <form action="{% url 'centers:toggle_staff_status' staff.id %}" method="POST"
                                        class="d-inline">
                                        {% csrf_token %}
                                        {% if staff.is_active %}
                                        <button type="submit" class="btn btn-sm btn-outline-warning"
                                            title="Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø­Ø³Ø§Ø¨"
                                            onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥ÙŠÙ‚Ø§Ù Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸ÙØŸ Ù„Ù† ÙŠØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù†Ø¸Ø§Ù….')">
                                            <i class="fas fa-ban"></i>
                                        </button>
                                        {% else %}
                                        <button type="submit" class="btn btn-sm btn-outline-success"
                                            title="ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨">
                                            <i class="fas fa-check"></i>
                                        </button>
                                        {% endif %}
                                    </form>

                                    <!-- Ø²Ø± Ø§Ù„Ø­Ø°Ù -->
                                    <form action="{% url 'centers:delete_staff' staff.id %}" method="POST"
                                        class="d-inline ms-1">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-sm btn-outline-danger" title="Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ"
                                            onclick="return confirm('ØªØ­Ø°ÙŠØ± Ø®Ø·ÙŠØ±! ğŸš«\nÙ‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ ØªÙ…Ø§Ù…Ø§Ù‹ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸Ù Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ\nÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡!')">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </form>
                                    {% else %}
                                    <span class="text-muted small fst-italic">Ø­Ø³Ø§Ø¨Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ</span>
                                    {% endif %}
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="6" class="text-center py-5 text-muted">
                                    <i class="fas fa-users-slash fa-3x mb-3 text-light"></i>
                                    <p class="mb-0">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø±ÙƒØ² Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</p>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}